## Security Requirements Implementation

| **Criteria**                              | **Requirements**                                                                                                                                                                                                 | **Implementation in Code**                                                                                                                                                                                                 |
|-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Password Authentication**               | - Enforcing password policy <br> - Secure password storage <br> - Prevention of password guessing <br> - Password recovery                                                                                      | - Password validation is not currently implemented, but we will enforce a password policy during user registration in `authController.js`. <br> - Passwords are securely hashed using `bcrypt` in `passwordUtils.js`. <br> - Rate-limiting middleware was implemented to prevent brute force attacks. <br> - Password recovery is not currently implemented. We consider adding a secure password recovery mechanism using time-limited tokens sent via email. |
| **Session Authentication and Management** | - Secure mechanisms for using access tokens: prevention of tampering and guessing, expiration control, etc. <br> - CSRF Defense <br> - Session hijacking defense                                                     | - JWT tokens are generated in `authController.js` using `jsonwebtoken` with a secret key (`SESSION_SECRET`) and expiration set for 7 days. <br> - CSRF protection is implemented using `csrfMiddleware.js`, but is not applied to all routes. <br> - Secure cookies are configured in `csrfMiddleware.js` with `httpOnly`, `secure`, and `sameSite` attributes. |
| **Authorization**                         | - Implement suitable access control: MAC, DAC, RBAC                                                                                                                                                             | - Access control is implemented in `authMiddleware.js` using `hasRole` and `hasRoleAssigned` to enforce RBAC. Roles like `JobSeeker` and `Recruiter` are validated in `authController.js`. |
| **Input Validation and Output Sanitization** | - Input validation and sanitization <br> - Protection against Injection attacks <br> - Prevention of path traversal, directory indexing <br> - Upload file restriction                                               | - Input validation is implemented using `express-validator` and `xss`. For example, `validateJobInput` ensures fields like `title`, `description`, and `location` are validated and sanitized. <br> - Knex.js is used for database queries, which parameterizes inputs to prevent SQL injection. Additionally, `xss` is used to sanitize inputs to prevent XSS attacks. <br> - File upload paths are not explicitly validated. Ensure file upload paths are validated to prevent directory traversal attacks. <br> - Resume uploads are sanitized using `xss`, but file type and size restrictions are not enforced. |
| **Prevention of Sensitive Information Leakage** | - Minimization of sensitive information leakage about servers, software, and applications <br> - Minimization of sensitive information leakage in response                                                            | - Error messages are logged securely using `logger.error` and generic error responses (e.g., `Failed to create job posting`) are sent to the client. <br> - Responses like `Invalid job ID format` and `Job not found` are generic and do not reveal sensitive details about the database or server configuration. |
